
@{
    ViewBag.Title = "LogIn";

}

<h2>LogIn</h2>

<div class="col-sm-4">
    <form id="idForm" data-bind="submit: register" method="post">
        <h3>Log In</h3>


        <div class="form-group">
            <label> Username</label>
            <input class="form-control" id="UserName" type="text" onkeyup="validateUserName()" data-bind="value:UserName" /> <label id="commentUserNamePrompt"></label>
        </div>


        <div class="form-group">
            <label>Password</label>
            <input class="form-control" id="Password" type="password" onkeyup="validatePassword()" data-bind="value:Password" /> <label id="commentPasswordPrompt"></label>
        </div>
        <div class="form-group">
            <button type="button" onclick="sendLogIn()" class="btn btn-default">Log In</button>
        </div>


    </form>
</div>

@section scripts{

    <script>

        function sendLogIn() {
            //alert($('#UserName').val());
            //alert($('#Password').val());


            //var reqdata = {
            //    username: 'JonnaElf',
            //    password: 'Vintergatan-154',
            //    grant_type: 'password'
            //}

            //var stringReqdata = JSON.stringify(reqdata);

            //alert(stringReqdata);


            $.ajax({
                url: 'http://localhost:55579/token',
                method: 'POST',
                contentType: 'application/json',
                data: {
                    username: $('#UserName').val(),
                    password: $('#Password').val(),
                    grant_type: 'password'


                },

                success: function (response) {
                    sessionStorage.setItem('acessToken', response.acess_token);
                    //window.location.href = "/Home/VisualSettings"
                    window.location.href = '@Url.Action("VisualSettings", "Home")/';


                    alert("Det gick bra att logga in" + JSON.stringify(response));
                },
                error: function (JQxhr) {

                    alert("ajja bajja" + JSON.stringify(JQxhr));

                }














                //$.ajax({
                //    url: "http://localhost:55579/token",
                //    method: "POST",
                //    data: stringReqdata,
                //    contentType: 'application/json; charset=utf-8',

                //    success: function (response) {

                //        alert("Det gick bra att logga in" + JSON.stringify(response));
                //    },
                //    error: function (JQxhr) {

                //        alert("ajja bajja" + JSON.stringify(JQxhr));

                //    }


            });

        }


          //username: $('#UserName').val(),
                    //password: $('#Password').val(),
                    //username: 'JonnaElf',
                    //password: 'Vintergatan - 154',
                    //grant_type: 'password'



    </script>




}